# ВЕЛИКИЙ И МОГУЧИЙ
**Категория:** Разборка Жигули (reverse)\
**Автор:** [Doom](https://t.me/dontunique)\
**Количество решений:** 6\
**Категория:** Разборка Жигули (reverse)

Привет, я путешественник во времени, смотри что добыл для тебя. Оказывается у наших предков тоже был ассемблер, правда какой-то странный. Разберись, также прикладываю их инструкцию



Формат флага goidactf{получившееся значение}

### Решение

1. Открываем видео и переписываем текст: 3 2 ВИТЯЗЬ 2 КИКИМОРА  1 2 КАЛИНА 1 ВИТЯЗЬ СОЛОВЕЙ МРАК 1 КИКИМОРА 1 СОЛОВЕЙ 6 КИКИМОРА СОЛОВЕЙ МРАК СОЛОВЕЙ МРАК 6 КИКИМОРА КИКИМОРА 6 КИКИМОРА СОЛОВЕЙ 1 2 ВИТЯЗЬ 2 КИКИМОРА ДОМОЙ
2. По приложенной инструкции, собираем функции, соответствующие названиям:
```
stack.append(int(cmd))
        elif cmd == "ВИТЯЗЬ":  # Сложение
            stack.append(stack.pop() + stack.pop())
        elif cmd == "КАЛИНА":  # Умножение
            stack.append(stack.pop() * stack.pop())
        elif cmd == "СВЕТИ":  # Вывод верхушки стека
            value = stack.pop()
            print(f"[DEBUG] ASCII Output: {value} ({chr(value)})")  # Отладка
            print(chr(value), end="")
        elif cmd == "КИКИМОРА":  # XOR
            a, b = stack.pop(), stack.pop()
            stack.append(a ^ b)
        elif cmd == "СОЛОВЕЙ":  # Дублирование
            stack.append(stack[-1])
        elif cmd == "МРАК":  # Уменьшение на 1
            stack.append(stack.pop() - 1)
        elif cmd == "ДОМОЙ":  # Завершение программы
```
3. Понимаем, что логика работы программы: [par1] [par2] <command>
4. Собираем солвер:
```
def калина(стек):
    a = стек.pop()
    b = стек.pop()
    результат = a * b
    стек.append(результат)
def мрак(стек):
    стек[-1] -= 1

def соловей(стек):
    стек.append(стек[-1])

def витязь(a, b):
    return a + b

def кикимора(a, b):
    return a ^ b

def свети(string):
    return print(string)

стек = []

свети("[+] STEP 1: 3 2 ВИТЯЗЬ")

стек.append(3)
стек.append(2)
результат1 = витязь(стек.pop(), стек.pop())  # 3 + 2 = 5
стек.append(результат1)
свети(f"[3, 2] -> {стек}\n")

свети("[+] STEP 2: 2 КИКИМОРА")

результат2 = кикимора(стек.pop(), 2)  # 5 XOR 2 = 7
стек.append(результат2)
свети(f"[{стек[:-1]}, 2] -> {стек}\n")

свети("[+] STEP 3: 1 2 КАЛИНА")

стек.append(1)
стек.append(2)
калина(стек)
свети(f"[{стек[:-2]}] -> {стек}\n")

свети("[+] STEP 4: 1 ВИТЯЗЬ")

результат4 = витязь(стек.pop(), 1)  # 7 + 1
стек.append(результат4)
свети(f"[{стек[:-1]}, 1] -> {стек}\n")

свети("[+] STEP 5: СОЛОВЕЙ")

соловей(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")

свети("[+] STEP6: МРАК")

мрак(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")

свети("[+] STEP 7: 1 КИКИМОРА")

результат5 = кикимора(стек.pop(), 1)
стек.append(результат5)
свети(f"[{стек[:-1]}, 1] -> {стек}\n")

свети("[+] STEP 8: 1 СОЛОВЕЙ")
стек.append(1)
соловей(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")

свети("[+] STEP 9: 6 КИКИМОРА")
результат6 = кикимора(стек.pop(), 6)
стек.append(результат6)
свети(f"[{стек[:-1]}, 6] -> {стек}\n")

свети("[+] STEP 10: СОЛОВЕЙ")
соловей(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")


свети("[+] STEP 11: МРАК")
мрак(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")

свети("[+] STEP 12: СОЛОВЕЙ")
соловей(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")

свети("[+] STEP 13: МРАК")
мрак(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")

свети("[+] STEP 14: 6 КИКИМОРА ")
результат7 = кикимора(стек.pop(), 6)
стек.append(результат7)
свети(f"[{стек[:-1]}, 6] -> {стек}\n")

свети("[+] STEP 15: КИКИМОРА")
результат8 = кикимора(стек.pop(), стек.pop())
стек.append(результат8)
свети(f"[{стек[:-2]}] -> {стек}\n")

свети("[+] STEP 16: 6 КИКИМОРА")
результат9 = кикимора(стек.pop(), 6)
стек.append(результат9)
свети(f"[{стек[:-1]}, 6] -> {стек}\n")

свети("[+] STEP 17: СОЛОВЕЙ")
соловей(стек)
свети(f"[{стек[:-1]}] -> {стек}\n")

свети("[+] STEP 18: 1 2 ВИТЯЗЬ")
стек.append(1)
стек.append(2)
результат10 = витязь(стек.pop(), стек.pop())  # 1 + 2
стек.append(результат10)
свети(f"[{стек[:-2]}, 1, 2] -> {стек}\n")

свети("[+] STEP 19: 2 КИКИМОРА")
результат11 = кикимора(стек.pop(), 2)
стек.append(результат11)
свети(f"[{стек[:-1]}, 2] -> {стек}\n")

свети("ГОЙДААААААААААА")
```
5. Получаем флаг: goidactf{73317331}
